<html>

<head>
    <title>Data transfer complete</title>
</head>
<style>
    body {
        font-family: "Open Sans", serif;
        background-color: rgb(56, 56, 56);
        text-align: center;
        color: white;
    }

    a {
        color: #1E90FF;
    }

    .contents {
        margin-left: 20%;
        margin-right: 20%;
    }

    .underline {
        text-decoration: underline;
    }

    .bold {
        font-weight: bold;
    }

    .left {
        text-align: left;
        text-indent: 2em;
        line-height: 1.7em;
        font-weight: bold;
        font-size: 16px;
    }
</style>

<body>
    <div class="contents">
        <br>
        <h1>Data Received</h1>
        <hr>
        <div class="left">
            <p>Your save data has been uploaded to the new website, if you keep playing and make more progress you'll
                need to do another transfer.</p>
            <p>Your future proof, enjoy :)</p>
            <a href="javascript:history.back()">Go back</a>
        </div>
    </div>

    <script>
        let receivedChunks = [];
        let totalChunks = 0;

        window.addEventListener('message', function (event) {
            // Ensure that the message comes from the expected domain
            if (event.origin !== 'https://domainA.com') {
                return; // Ignore messages from unknown origins
            }

            // Handle the message containing a chunk of data
            if (event.data.action === 'sendChunk') {
                receivedChunks[event.data.index] = event.data.chunk; // Store the chunk
                totalChunks++;

                // If all chunks are received, reassemble the full data
                if (totalChunks === receivedChunks.length) {
                    const fullData = receivedChunks.join(''); // Reassemble the data
                    localStorage.setItem('RetroBowl.0.savedata.ini', fullData); // Store the full data in localStorage
                    console.log('Game save data successfully received and reassembled!');
                }
            }
        });
    </script>

</body>

</html>